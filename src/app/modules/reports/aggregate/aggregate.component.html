<p-toast key="item" position="bottom-left"></p-toast>

<div class="table-header">
  نام گزارش : <span> {{ selectedReport?.title }}</span>
</div>

<div class="panel-search mt-8 mb-8">
  <form #formDir="ngForm" [formGroup]="accountReportPriceForm">
    <div class="row mt-8 pb-3">
      <!--  شرکت -->
      <div class="col-2">
        <label for="companyId"> شرکت </label>
        <p-dropdown
          id="companyId"
          name="companyId"
          formControlName="companyId"
          styleClass="w-100 my-1"
          optionLabel="companyName"
          optionValue="id"
          placeholder="انتخاب کنید"
          [options]="companyList"
          [filter]="true">
        </p-dropdown>
      </div>
      <!--  شرکت -->
      <!--  دوره بودجه -->
      <div class="col-2">
        <label for="periodId">دوره بودجه </label>
        <p-dropdown
          id="periodId"
          name="periodId"
          formControlName="periodId"
          styleClass="w-100 my-1"
          optionLabel="periodTitle"
          optionValue="id"
          placeholder="انتخاب کنید"
          [options]="periodList"
          [filter]="true"
          (onChange)="onChangePeriod($event)">
        </p-dropdown>
      </div>
      <!--  دوره بودجه -->
      <!--  دوره عملیاتی -->
      <div class="col-2">
        <label for="fromPeriodDetailId"> از دوره عملیاتی </label>
        <p-dropdown
          id="fromPeriodDetailId"
          name="fromPeriodDetailId"
          formControlName="fromPeriodDetailId"
          styleClass="w-100 my-1"
          optionLabel="periodDetailTitle"
          optionValue="id"
          placeholder="انتخاب کنید"
          [options]="periodDetailLst"
          [filter]="true">
        </p-dropdown>
      </div>
      <div class="col-2">
        <label for="toPeriodDetailId">تا دوره عملیاتی </label>
        <p-dropdown
          id="toPeriodDetailId"
          name="toPeriodDetailId"
          formControlName="toPeriodDetailId"
          styleClass="w-100 my-1"
          optionLabel="periodDetailTitle"
          optionValue="id"
          placeholder="انتخاب کنید"
          [options]="periodDetailLst"
          [filter]="true">
        </p-dropdown>
      </div>
      <!--  دوره عملیاتی -->

      <div class="col-4 align-content-end pb-2">
        <div class="d-flex align-items-center">
          <p-radioButton
            name="priceType"
            formControlName="priceType"
            [value]="2"
            inputId="ingredient2"></p-radioButton>
          <label for="ingredient2" class="ms-2 me-4">مبلغ عملکرد</label>
          <!-- </div>

        <div class="d-flex align-items-center"> -->
          <p-radioButton
            name="priceType"
            formControlName="priceType"
            [value]="1"
            inputId="ingredient1"></p-radioButton>
          <label for="ingredient1" class="ms-2 me-4">مبلغ بودجه</label>
        </div>
      </div>
    </div>
    <!-- دکمه -->
    <div class="d-flex justify-content-end col text-end">
      <div class="search-button mt-12">
        <div class="clear-search" (click)="clearSearch()">
          <i class="pi pi-filter-slash"></i>
        </div>
        <p-button
          class="pe-2 p-button-wide"
          styleClass="p-button-info"
          [label]="'جستجو'"
          (click)="getAccountReportItemLst()"></p-button>
      </div>
    </div>
    <!-- / دکمه -->
  </form>
</div>
<div class="table-container">
  <!-- <form #formDir="ngForm" [formGroup]="dynamicControls"> -->
  <p-table
    #dataTable
    dataKey="id"
    class="data-table d-none d-lg-block"
    [styleClass]="gridClass"
    [rowHover]="true"
    [paginator]="true"
    [rows]="dataTableRows"
    [rowsPerPageOptions]="[5, 10, 15]"
    [totalRecords]="totalCount"
    [value]="accountReportItemList"
    [loading]="loading"
    [tableStyle]="{ 'min-width': '75rem' }"
    [(first)]="first">
    <!-- table header -->
    <ng-template pTemplate="header">
      <tr class="data-table__header">
        <th><strong> ردیف </strong></th>
        <th><strong> نام آیتم </strong></th>
        <th><strong> مبلغ (ریال)</strong></th>
        <th><strong> </strong></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-item let-rowIndex="rowIndex">
      <tr>
        <td style="min-width: 15rem">{{ rowIndex + 1 }}</td>
        <td style="min-width: 15rem">{{ item.accountRepItemTitle }}</td>
        <td pEditableColumn style="min-width: 15rem">
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="text"
                [(ngModel)]="item.priceCu"
                (change)="onChangePrice(item)" />
            </ng-template>
            <ng-template pTemplate="output">
              {{ item.priceCu }}
            </ng-template>
          </p-cellEditor>
          &nbsp;
        </td>
        <td></td>
      </tr>
    </ng-template>
  </p-table>
  <!-- </form> -->

  <div class="d-flex justify-content-end" style="padding: 13px 2px">
    <p-button
      class="pe-2 mr-8"
      styleClass="p-button-info"
      icon="pi pi-plus-circle"
      label="ذخیره تغییرات"
      (click)="addList()"></p-button>
  </div>
</div>

<p-confirmDialog [style]="{ width: '450px' }" [rtl]="true"></p-confirmDialog>
