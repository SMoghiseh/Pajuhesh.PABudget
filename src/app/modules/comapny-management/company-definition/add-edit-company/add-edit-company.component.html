<!-- pop up messages -->

<p-toast key="uploadFile" position="bottom-left"></p-toast>
<p-toast key="companyDefinition" position="bottom-left"></p-toast>

<p-panel class="search-panel__secation pb-1" header="{{ formHeader }}">
  <form #formDir="ngForm" [formGroup]="addNewCompanyForm" (ngSubmit)="addNewCompany()">
    <div class="container row">
      <!--  والد -->
      <div class="col-3 mt-2">
        <label for="parentId">والد </label>
        <p-dropdown id="parentId" name="parentId" formControlName="parentId" class="col-3 mt-2" styleClass="w-100 my-1"
          optionLabel="companyName" optionValue="id" placeholder="انتخاب کنید" [options]="parents" [filter]="true"
          [showClear]="true">
        </p-dropdown>
      </div>
      <!-- /  والد -->
      <!-- شناسه ملی -->
      <div class="col-3 mt-2">
        <label for="nationalID">شناسه ملی</label>
        <input pInputText id="nationalID" name="nationalID" formControlName="nationalID" type="text" class="w-100"
          [class.ng-invalid]="nationalID?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && nationalID?.pristine) ||
            nationalID?.dirty ||
            nationalID?.touched
          " [value]="nationalID?.value | faNum" />
      </div>
      <!-- / شناسه ملی -->

      <!-- سرمایه ثبت شده -->
      <div class="col-3 mt-2">
        <label for="registeredCapital">سرمایه ثبت شده</label>
        <p-inputNumber id="registeredCapital" formControlName="registeredCapital" type="text" pKeyFilter="int"
          [minlength]="0" class="w-100" [class.ng-invalid]="registeredCapital?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && registeredCapital?.pristine) ||
            registeredCapital?.dirty ||
            registeredCapital?.touched
          "></p-inputNumber>
      </div>
      <!-- / سرمایه ثبت شده -->

      <!-- نام شرکت -->
      <div class="col-3 mt-2">
        <label for="companyName">نام شرکت</label>
        <input pInputText id="companyName" name="companyName" formControlName="companyName" type="text" class="w-100"
          [class.ng-invalid]="companyName?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && companyName?.pristine) ||
            companyName?.dirty ||
            companyName?.touched
          " />
      </div>
      <!-- / نام شرکت -->
      <!-- شماره ثبت -->
      <div class="col-3 mt-2">
        <label for="registerNumber">شماره ثبت</label>
        <input pInputText id="registerNumber" name="registerNumber" formControlName="registerNumber" type="text"
          class="w-100" [class.ng-invalid]="registerNumber?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && registerNumber?.pristine) ||
            registerNumber?.dirty ||
            registerNumber?.touched
          " [value]="registerNumber?.value | faNum" />
      </div>
      <!-- / شماره ثبت -->
      <!-- تاریخ ثبت -->
      <div class="col-3 mt-2">
        <label for="registerDate">تاریخ ثبت</label>
        <p-persian-calendar id="registerDate" name="registerDate" formControlName="registerDate" styleClass="w-100 "
          [class.ng-invalid]="registerDate?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && registerDate?.pristine) ||
            registerDate?.dirty ||
            registerDate?.touched
          ">
        </p-persian-calendar>
      </div>
      <!-- / تاریخ ثبت -->
      <!-- نوع شرکت -->
      <div class="col-3 mt-2">
        <label for="companyTypeId">نوع شرکت</label>
        <p-dropdown id="companyTypeId" name="companyTypeId" formControlName="companyTypeId" class="col-3 mt-2"
          styleClass="w-100 my-1" optionLabel="title" optionValue="id" placeholder="انتخاب کنید"
          [class.ng-invalid]="companyTypeId?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && companyTypeId?.pristine) ||
            companyTypeId?.dirty ||
            companyTypeId?.touched
          " [options]="companyTypes" [filter]="true" [showClear]="true">
        </p-dropdown>
      </div>
      <!-- / نوع شرکت -->
      <!-- نوع فعالیت -->
      <div class="col-3 mt-2">
        <label for="activityTypeId">نوع فعالیت (صنعت)</label>
        <p-dropdown id="activityTypeId" name="activityTypeId" formControlName="activityTypeId" class="col-3 mt-2"
          styleClass="w-100 my-1" optionLabel="title" optionValue="id" placeholder="انتخاب کنید"
          [class.ng-invalid]="activityTypeId?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && activityTypeId?.pristine) ||
            activityTypeId?.dirty ||
            activityTypeId?.touched
          " [options]="activityTypes" [filter]="true" [showClear]="true">
        </p-dropdown>
      </div>
      <!-- / نوع فعالیت -->

      <!-- نام نماد -->
      <!-- <div class="col-3 mt-2" *ngIf="this.companySelected.companyTypeId == 1"> -->
      <div class="col-6 mt-2">
        <label for="symbol">نام نماد</label>
        <input pInputText id="symbol" name="symbol" formControlName="symbol" type="text" class="w-100"
          [class.ng-invalid]="symbol?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && symbol?.pristine) ||
            symbol?.dirty ||
            symbol?.touched
          " />
      </div>
      <!-- / نام نماد -->
      <!-- نام لاتین -->
      <div class="col-6 mt-2">
        <label for="latinName">نام لاتین</label>
        <input pInputText  id="latinName" name="latinName" formControlName="latinName"
          type="text" class="w-100" [class.ng-invalid]="latinName?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && latinName?.pristine) ||
            latinName?.dirty ||
            latinName?.touched
          " />
      </div>
      <!-- / نام لاتین -->
      <!-- شروع سال مالی -->
      <div class="col-3 mt-8">
        <label for="toDate"> شروع سال مالی</label>
        <p-dropdown id="startFiscalYearId" class="col" styleClass="w-100" optionValue="id" optionLabel="title"
          [options]="fiscalYearList" placeholder="انتخاب کنید" formControlName="startFiscalYearId">
        </p-dropdown>
      </div>
      <!-- / شروع سال مالی -->
      <!-- ماهیت -->
      <div class="col-3 mt-2">
        <label for="reportingTypeId">ماهیت</label>
        <p-dropdown id="reportingTypeId" name="reportingTypeId" formControlName="reportingTypeId" class="col-3 mt-2"
          styleClass="w-100 my-1" optionLabel="title" optionValue="id" placeholder="انتخاب کنید"
          [options]="reportingTypes" [class.ng-invalid]="reportingTypeId?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted && reportingTypeId?.pristine) ||
            reportingTypeId?.dirty ||
            reportingTypeId?.touched
          " [showClear]="true">
        </p-dropdown>
      </div>
      <!-- / ماهیت -->
      <!-- موسسه حسابرسی شرکت -->
      <div class="col-3 mt-2">
        <label for="companyInspectionInstituteId">موسسه حسابرسی شرکت</label>
        <p-dropdown id="companyInspectionInstituteId" name="companyInspectionInstituteId"
          formControlName="companyInspectionInstituteId" class="col-3 mt-2" styleClass="w-100 my-1" optionLabel="title"
          optionValue="id" placeholder="انتخاب کنید" [options]="companyInspectionInstitutes" [showClear]="true"
          [class.ng-invalid]="companyInspectionInstituteId?.invalid" [class.ng-dirty]="
            (addNewCompanySubmitted &&
              companyInspectionInstituteId?.pristine) ||
            companyInspectionInstituteId?.dirty ||
            companyInspectionInstituteId?.touched
          " [showClear]="true">
        </p-dropdown>
      </div>
      <!-- / موسسه حسابرسی شرکت -->
      <!-- تاریخ شروع حسابرسی -->
      <!-- <div class="col-3 mt-2">
        <label for="auditStart">تاریخ شروع حسابرسی</label>
        <p-persian-calendar id="auditStart" name="auditStart" formControlName="auditStart" styleClass="w-100 ">
        </p-persian-calendar>
      </div> -->
      <!-- / تاریخ شروع حسابرسی -->
      <!-- تاریخ پایان حسابرسی -->
      <!-- <div class="col-3 mt-2">
        <label for="auditEnd">تاریخ پایان حسابرسی</label>
        <p-persian-calendar id="auditEnd" name="auditEnd" formControlName="auditEnd" styleClass="w-100">
        </p-persian-calendar>
      </div> -->
      <!-- / تاریخ پایان حسابرسی -->
      <!--  کد سیستمی  -->
      <div class="col-3 mt-2">
        <label for="systemOrganizationCode"> کد سیستمی</label>
        <input pInputText id="systemOrganizationCode" name="systemOrganizationCode"
          formControlName="systemOrganizationCode" type="text" class="w-100" />
      </div>
      <!-- / کد سیستمی   -->

      <!-- نمابر امور سهام (کد) -->
      <!-- <div class="col-3 mt-2">
        <label for="stockAffairsFax">نمابر امور سهام (کد)</label>
        <input pInputText id="stockAffairsFax" name="stockAffairsFax" formControlName="stockAffairsFax" type="text"
          class="w-100" />
      </div> -->
      <!-- / نمابر امور سهام (کد) -->
      <!-- <div class="col-3 mt-2"></div> -->
      <div class="row col-12 p-0 m-0">
        <!-- تلفن کارخانه (کد) -->
        <div class="col-3 mt-2">
          <label for="factoryTelephone">تلفن کارخانه (کد)</label>
          <input pInputText id="factoryTelephone" name="factoryTelephone" formControlName="factoryTelephone" type="text"
            class="w-100" />
        </div>
        <!-- / تلفن کارخانه (کد) -->

        <!-- نمابر کارخانه (کد) -->
        <div class="col-3 mt-2">
          <label for="factoryFax">نمابر کارخانه (کد)</label>
          <input pInputText id="factoryFax" name="factoryFax" formControlName="factoryFax" type="text" class="w-100" />
        </div>
        <!-- / نمابر کارخانه (کد) -->
        <!-- آدرس کارخانه -->
        <div class="col-6">
          <label for="factoryAddress">آدرس کارخانه</label>
          <input pInputText id="factoryAddress" name="factoryAddress" formControlName="factoryAddress" type="text"
            class="w-100" />
        </div>
        <!-- / آدرس کارخانه -->
      </div>
      <!-- تلفن امور سهام (کد) -->
      <!-- <div class="col-3 mt-2">
        <label for="stockAffairsTelephone">تلفن امور سهام (کد)</label>
        <input pInputText id="stockAffairsTelephone" name="stockAffairsTelephone"
          formControlName="stockAffairsTelephone" type="text" class="w-100" />
      </div> -->
      <!-- / تلفن امور سهام (کد) -->

      <!-- آدرس امور سهام -->
      <!-- <div class="col-6 mt-2">
        <label for="stockAffairsOffice">آدرس امور سهام</label>
        <input pInputText id="stockAffairsOffice" name="stockAffairsOffice" formControlName="stockAffairsOffice"
          type="text" class="w-100" />
      </div> -->
      <!-- / آدرس امور سهام -->
      <div class="row col-12 p-0 m-0">
        <!-- تلفن دفتر مرکزی (کد) -->
        <div class="col-3 mt-2">
          <label for="centeralOfficeTelephone">تلفن دفتر مرکزی (کد)</label>
          <input pInputText id="centeralOfficeTelephone" name="centeralOfficeTelephone"
            formControlName="centeralOfficeTelephone" type="text" class="w-100" />
        </div>
        <!-- / تلفن دفتر مرکزی (کد) -->
        <!-- نمابر دفتر مرکزی (کد) -->
        <div class="col-3 mt-2">
          <label for="centeralOfficeFax">نمابر دفتر مرکزی (کد)</label>
          <input pInputText id="centeralOfficeFax" name="centeralOfficeFax" formControlName="centeralOfficeFax"
            type="text" class="w-100" />
        </div>
        <!-- / نمابر دفتر مرکزی (کد) -->
        <!-- آدرس دفتر مرکزی -->
        <div class="col-6 mt-2">
          <label for="centeralOffice">آدرس دفتر مرکزی</label>
          <input pInputText id="centeralOffice" name="centeralOffice" formControlName="centeralOffice" type="text"
            class="w-100" />
        </div>
        <!-- / آدرس دفتر مرکزی -->
      </div>

      <!-- موضوع فعالیت -->
      <div class="col-12 mt-2 pr-4 m-0">
        <label for="activitySubject">اساسنامه</label>
        <textarea pInputTextarea id="activitySubject" name="activitySubject" formControlName="activitySubject" rows="3"
          cols="10" class="w-100"></textarea>
      </div>
      <!-- / موضوع فعالیت -->
      <!-- آپلود فایل -->
      <div class="mt-2 fileUploader">
        <label for="partyLogo"> لوگو </label>
        <div>
          <p-fileUpload *ngIf="!companySelected.multiMediaId" #form id="partyLogo" mode="basic"
            class="upload-file-button" chooseLabel=" آپلود فایل" name="attachments[]"
            [disabled]="isDisableaddAmendmentBtn" [auto]="true"
            (onSelect)="uploadAttachment($event.files, form)"></p-fileUpload>
          <p-button *ngIf="companySelected.multiMediaId" id="partyLogo" mode="basic"
            class="download-file-button p-button-info" icon="pi pi-download" label=" دانلود فایل" (onClick)="
              downloadAttachmnet(companySelected.multiMediaId)
            "></p-button>

          <div *ngIf="companySelected.multiMediaId" class="remove-file">
            <span>حذف فایل
              <i class="pi pi-times" (click)="removePreviousLogo()"></i></span>
          </div>
        </div>
      </div>
      <!-- /آپلود فایل -->
    </div>

    <!-- دکمه ها -->
    <div class="d-flex justify-content-center justify-content-md-end pt-3 w-100">
      <p-button class="pe-2 p-button-wide" styleClass="p-button-success" [label]="buttonLabel" type="submit"
        [loading]="addNewCompanyLoading"></p-button>

      <p-button class="pe-2 p-button-wide" icon="pi pi-arrow-left" styleClass="p-button-info back-btn" label="بازگشت"
        (click)="onBack()"></p-button>
    </div>
    <!-- / دکمه ها -->
  </form>
</p-panel>